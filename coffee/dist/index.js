!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.ManhattanTypeahead=e():t.ManhattanTypeahead=e()}(this,function(){return function(t){function __webpack_require__(n){if(e[n])return e[n].exports;var i=e[n]={exports:{},id:n,loaded:!1};return t[n].call(i.exports,i,i.exports,__webpack_require__),i.loaded=!0,i.exports}var e={};return __webpack_require__.m=t,__webpack_require__.c=e,__webpack_require__.p="",__webpack_require__(0)}([function(t,e,n){n(1),t.exports=n(2)},function(t,e,n){t.exports=n.p+"typeahead.css"},function(t,e,n){var i,r;i=n(3),r=function(){function Typeahead(t,e){var n;null==e&&(e={}),i.config(this,{autoFirst:!1,list:[],maxItems:10,minChars:2,mustMatch:!1,rootTag:"div"},e,t,this.constructor.clsPrefix),this._behaviours={},n="array","string"==typeof this.list&&(n="#"===this.list[0]?"data-list":"string"),i.config(this._behaviours,{coerce:"pass-through",element:"default",fetch:n,filter:"startswith",input:"set-value",sort:"length"},e,t,this.constructor.clsPrefix),this._index=-1,this._isOpen=!1,this._cache=null,this._dom={},this._dom.input=t,this._dom.input.__mh_typeahead=this,this._dom.suggestions=i.create(this.rootTag,{class:[this._bem("mh-typeahead"),this._bem("mh-typeahead","","closed")].join(" ")}),document.body.appendChild(this._dom.suggestions),this._dom.input.setAttribute("autocomplete","off"),Object.defineProperty(this,"index",{get:function(t){return function(){return t._index}}(this)}),Object.defineProperty(this,"input",{value:this._dom.input}),Object.defineProperty(this,"isOpen",{get:function(t){return function(){return t._isOpen}}(this)}),i.listen(this._dom.input,{blur:function(t){return function(){return t.close("blur")}}(this),input:function(t){return function(){return t.update()}}(this),keydown:function(t){return function(e){if(t.isOpen)switch(e.keyCode){case 9:if(t.mustMatch)return t.select();break;case 13:if(t.index>-1)return e.preventDefault(),t.select();break;case 27:return t.close("esc");case 38:return e.preventDefault(),t.previous();case 40:return e.preventDefault(),t.next()}}}(this)}),i.listen(this._dom.suggestions,{mousedown:function(t){return function(e){var n,i;if(e.target!==t._dom.suggestions&&0===e.button){for(e.preventDefault(),i=e.target;i.parentNode!==t._dom.suggestions;)i=i.parentNode;return n=Array.prototype.indexOf.call(t._dom.suggestions.children,i),t.select(n)}}}(this)}),i.listen(window,{"fullscreenchange orientationchange resize":function(t){return function(e){if(t.isOpen)return t.close("resize")}}(this)})}return Typeahead.clsPrefix="data-mh-typeahead--",Typeahead.prototype.clear=function(){return this.constructor.behaviours.input[this._behaviours.input](this,null),i.dispatch(this.input,this._et("clear"))},Typeahead.prototype.clearCache=function(){return this._cache=null},Typeahead.prototype.close=function(t){if(this.isOpen)return this._dom.suggestions.classList.add(this._bem("mh-typeahead","","closed")),this._isOpen=!1,this.index=-1,i.dispatch(this.input,this._et("close"),{reason:t})},Typeahead.prototype.fromCache=function(t,e){if(this._cache&&this._cache[t])return this._cache[t][e]},Typeahead.prototype.next=function(){var t;if(t=this._suggestions.length,0!==t)return this.index>=t-1?this._goto(0):this._goto(this.index+1)},Typeahead.prototype.open=function(){return this._track(),this._dom.suggestions.classList.remove(this._bem("mh-typeahead","","closed")),this._isOpen=!0,this.autoFirst&&this.index===-1&&this._goto(0),i.dispatch(this.input,this._et("open"))},Typeahead.prototype.previous=function(){var t;if(t=this._suggestions.length,0!==t)return this.index<=0?this._goto(t-1):this._goto(this.index-1)},Typeahead.prototype.select=function(t){var e;if(void 0!==t&&t!==this.index&&this._goto(t),this.index>-1){if(e=this._suggestions[this.index],!i.dispatch(this.input,this._et("select"),{item:e}))return;return this.constructor.behaviours.input[this._behaviours.input](this,e),this.close("select"),i.dispatch(this.input,this._et("selected"),{item:e})}},Typeahead.prototype.toCache=function(t,e,n){return this._cache||(this._cache={}),this._cache[t]||(this._cache[t]={}),this._cache[t][e]=n},Typeahead.prototype.update=function(){for(var t,e,n;this._dom.suggestions.firstChild;)this._dom.suggestions.removeChild(this._dom.suggestions.firstChild);return n=this.input.value.trim(),this.input.value.trim()||this.clear(),n.length<this.minChars?this.close("no-matches"):(t=function(t){return function(e){var i,r,s,o,u,a,h,c;if(0===e.length)return t.close("no-matches");if(i=t.constructor.behaviours.coerce[t._behaviours.coerce],e=e.map(function(e){return i(t,e)}),s=t.constructor.behaviours.filter[t._behaviours.filter],e=e.filter(function(e){return s(t,e,n)}),h=t.constructor.behaviours.sort[t._behaviours.sort],e=e.sort(function(e,i){return h(t,n,e,i)}),e=e.slice(0,t.maxItems),t._suggestions=e,t._index=-1,0===t._suggestions.length)return t.close("no-matches");for(r=t.constructor.behaviours.element[t._behaviours.element],a=t._suggestions,o=0,u=a.length;o<u;o++)c=a[o],t._dom.suggestions.appendChild(r(t,c,n));return t.open()}}(this),(e=this.constructor.behaviours.fetch[this._behaviours.fetch])(this,this.list,n,t))},Typeahead.prototype._bem=function(t,e,n){var i;return null==e&&(e=""),null==n&&(n=""),i=t,e&&(i=i+"__"+e),n&&(i=i+"--"+n),i},Typeahead.prototype._et=function(t){return"mh-typeahead--"+t},Typeahead.prototype._goto=function(t){var e,n,r;if(n=this._bem("mh-typeahead","suggestion","focused"),e=i.one("."+n),e&&e.classList.remove(n),this._index=t,t>-1&&this._suggestions.length>0)return r=this._dom.suggestions.children[t],r.classList.add(n),i.dispatch(this.input,this._et("focus"),{item:this._suggestions[t]})},Typeahead.prototype._track=function(){var t,e,n;return e=this._dom.input.getBoundingClientRect(),n=e.top+=window.scrollY,t=e.left+=window.scrollX,this._dom.suggestions.style.top=n+e.height+"px",this._dom.suggestions.style.left=t+"px",this._dom.suggestions.style.width=e.width+"px"},Typeahead.behaviours={coerce:{"pass-through":function(t,e){return e},"single-value":function(t,e){return{value:e,label:e}}},element:{default:function(t,e,n){var r;return r=i.create("div",{class:t._bem("mh-typeahead","suggestion")}),r.innerHTML=e.label.replace(RegExp(i.escapeRegExp(n),"gi"),"<mark>$&</mark>"),r}},fetch:{ajax:function(t,e,n,i){var r,s,o,u;return r=n.substr(0,t.minChars).toLowerCase(),(s=t.fromCache("ajax",r))?i(s):(o=e.split("?"),e=1===o.length?e+"?q="+n:e+"&q="+n,u=new XMLHttpRequest,u.addEventListener("load",function(e){var n,s;return s=JSON.parse(e.target.responseText),"success"===s.status?(n=s.payload.items,t.toCache("ajax",r,n),i(n)):i([])}),u.open("GET",e),u.send(null))},array:function(t,e,n,i){return i(e)},"data-list":function(t,e,n,r){var s,o,u,a,h,c,l;for(s=i.one(e),l=i.many("option",s),a=[],o=0,h=l.length;o<h;o++)c=l[o],u={},c.textContent&&(u.label=c.textContent.trim(),u.value=c.textContent.trim()),c.value&&(u.label||(u.label=c.value.trim()),u.value=c.value.trim()),a.push(u);return r(a)},element:function(t,e,n,r){var s,o,u,a,h;return o=i.many(e),h=function(){var t,e,n;for(n=[],t=0,e=o.length;t<e;t++)s=o[t],n.push(s.textContent);return n}(),u=function(){var t,e,n;for(n=[],t=0,e=h.length;t<e;t++)a=h[t],n.push({label:a.trim(),value:a.trim()});return n}(),r(u)},string:function(t,e,n,i){var r,s,o;return o=e.split(",").filter(function(t){return t.trim().length>0}),r=function(){var t,e,n;for(n=[],t=0,e=o.length;t<e;t++)s=o[t],n.push({label:s.trim(),value:s.trim()});return n}(),i(r)}},filter:{contains:function(t,e,n){var i;return i=e.value.toLowerCase(),i.indexOf(n.toLowerCase())>-1},startswith:function(t,e,n){var i;return i=e.value.toLowerCase().substr(0,n.length),n.toLowerCase()===i}},input:{"set-hidden":function(t,e){var n,r;return null===e?t.input.value="":t.input.value=e.label,r=t.input.getAttribute(t.constructor.clsPrefix+"hidden"),n=i.one(r),null===e?n.value="":n.value=e.id||e.value},"set-value":function(t,e){return null===e?t.input.value="":t.input.value=e.id||e.value}},sort:{length:function(t,e,n,i){var r,s;return e=e.toLowerCase(),r=e===n.value.substr(0,e.length).toLowerCase(),s=e===i.value.substr(0,e.length).toLowerCase(),r&&!s?-1:s&&!r?1:n.value.length!==i.value.length?n.value.length<i.value.length?-1:1:n.value<i.value?-1:1}}},Typeahead}(),t.exports={Typeahead:r}},function(t,e,n){!function(e,n){t.exports=n()}(this,function(){return function(t){function __webpack_require__(n){if(e[n])return e[n].exports;var i=e[n]={exports:{},id:n,loaded:!1};return t[n].call(i.exports,i,i.exports,__webpack_require__),i.loaded=!0,i.exports}var e={};return __webpack_require__.m=t,__webpack_require__.c=e,__webpack_require__.p="",__webpack_require__(0)}([function(t,e,n){t.exports=n(1)},function(t,e){var n,i,r,s,o,u,a,h,c=[].indexOf||function(t){for(var e=0,n=this.length;e<n;e++)if(e in this&&this[e]===t)return e;return-1};i=function(t,e){var n,i,r;null==e&&(e={}),n=document.createElement(t);for(i in e)r=e[i],c.call(n,i)>=0?n[i]=r:n.setAttribute(i,r);return n},a=function(t,e){return null==e&&(e=document),Array.prototype.slice.call(e.querySelectorAll(t))},h=function(t,e){return null==e&&(e=document),e.querySelector(t)},r=function(t,e,n){var i,r,s;null==n&&(n={}),i=document.createEvent("Event"),i.initEvent(e,!0,!0);for(r in n)s=n[r],i[r]=s;return t.dispatchEvent(i)},o=function(t,e){var n,i,r,s;s=[];for(i in e)r=e[i],s.push(function(){var e,s,o,u;for(o=i.split(/\s+/),u=[],e=0,s=o.length;e<s;e++)n=o[e],u.push(t.removeEventListener(n,r));return u}());return s},u=function(t,e){var n,i,r,s;s=[];for(i in e)r=e[i],s.push(function(){var e,s,o,u;for(o=i.split(/\s+/),u=[],e=0,s=o.length;e<s;e++)n=o[e],u.push(t.addEventListener(n,r));return u}());return s},n=function(t,e,n,i,r){var s,o,u,a;null==r&&(r="data-"),u=[];for(o in e)a=e[o],t[o]=a,n.hasOwnProperty(o)&&(t[o]=n[o]),s=r+o.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),i.hasAttribute(s)?"number"==typeof a?u.push(t[o]=parseInt(i.getAttribute(s))):a===!1?u.push(t[o]=!0):u.push(t[o]=i.getAttribute(s)):u.push(void 0);return u},s=function(t){return t.replace(/[\^\$\\\.\*\+\?\(\)\[\]\{\}\|]/g,"\\$&")},t.exports={create:i,one:h,many:a,dispatch:r,ignore:o,listen:u,config:n,escapeRegExp:s}}])})}])});